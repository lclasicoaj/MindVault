# Database Schema Setup

The error "new row violates row-level security policy" happens because we enabled "Private" mode (RLS) but didn't give your API key permission to write.

Copy and paste this **entire** block into the Supabase SQL Editor. It will create the tables (if missing) and fix the permissions.

```sql
-- 1. Create tables if they don't exist
create table if not exists public.blogs (
  id bigint generated by default as identity primary key,
  title text not null,
  content text not null,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null
);

create table if not exists public.recaps (
  id bigint generated by default as identity primary key,
  blog_id bigint not null references public.blogs(id) on delete cascade,
  question text not null,
  answer text not null,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null
);

-- 2. Enable Security (RLS)
alter table public.blogs enable row level security;
alter table public.recaps enable row level security;

-- 3. FIX: Add Policies
-- This tells Supabase: "Allow anyone with the API key to Read and Write"
-- Since your App Key is unique to you, this keeps it private enough for this use case.

drop policy if exists "Allow all access" on public.blogs;
create policy "Allow all access" on public.blogs for all using (true) with check (true);

drop policy if exists "Allow all access" on public.recaps;
create policy "Allow all access" on public.recaps for all using (true) with check (true);
```